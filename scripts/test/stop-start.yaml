---
# Playbook to perform integration testing on Celos
#
# Performs various tests against the servlets.

- hosts: host
  gather_facts: no
  vars:
    root: "../.."
    tests_dir: "{{root}}/celos-server/src/test/resources/com/collective/celos/workflow-configuration-test"
    service_url: "http://{{inventory_hostname}}:{{service_port}}"

  tasks:

  - ping:

  - shell: /sbin/sv start {{service_name}}

  - shell: "curl -f http://{{inventory_hostname}}:{{service_port}}/version"

  - shell: /sbin/sv stop {{service_name}}

  - shell: "! curl -f http://{{inventory_hostname}}:{{service_port}}/version"

  - shell: /sbin/sv start {{service_name}}

  - shell: "curl -f http://{{inventory_hostname}}:{{service_port}}/version"

